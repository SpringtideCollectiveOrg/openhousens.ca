{% extends 'speeches/base.html' %}
{% load url from future %}
{% load staticfiles legislature_extras %}

{% block title %}Bill No. {{ bill.identifier }} {{ bill.title }}{% endblock %}

{% block head %}
<link rel="alternate" type="application/rss+xml" href="http://nslegislature.ca/index.php/proceedings/rss_2.0/{{ bill.slug }}">
{% endblock %}

{% block content %}
{% include 'speeches/_breadcrumbs.html' %}

<div class="container-fluid" itemscope itemtype="http://schema.org/CreativeWork">
  <div class="row">
    <div class="col-sm-10 col-md-8 col-sm-offset-2">
      <header>
        <h1 itemprop="name">Bill No. {{ bill.identifier }}</h1>
        <p class="title" itemprop="alternateName">{{ bill.title }}</p>
{% if bill.description %}
        <p class="subtitle" itemprop="description">{{ bill.description }}</p>
{% endif %}
        <p>
          Subscribe to this <a href="http://nslegislature.ca/index.php/proceedings/rss_2.0/{{ bill.slug }}">RSS feed</a> to track changes to the bill's status.
          (The <a itemprop="url" href="{{ bill.url }}">original version</a> is on the legislature's site.)
        </p>
      </header>
    </div>
  </div>

{% if bill.creator %}
  <div class="row push-down">
    <div class="col-sm-2">
      <h2>Sponsor</h2>
    </div>
    <div class="col-sm-10 col-md-8" itemprop="creator" itemscope itemtype="http://schema.org/Person">
      <a href="{% url 'legislature:speaker-view' bill.creator.slug %}">
        <strong itemprop="name">{{ bill.creator.name|person_name }}</strong>
      </a>
    </div>
  </div>
{% endif %}

  <div class="row push-down">
    <div class="col-sm-2">
      <h2>Status</h2>
    </div>
    <div class="col-sm-10 col-md-8">
      <dl class="dl-horizontal">
{% for action in bill.actions %}
  {% if "Meeting Date(s)" not in action.description %}
    {% if "First Reading" in action.description %}
        <dt data-toggle="tooltip" title="The bill is introduced">
          {{ action.description }}
        </dt>
    {% elif "Second Reading Passed" in action.description %}
        <dt data-toggle="tooltip" title="The House votes to refer the bill to the Committee on Law Amendments">
          Second Reading
        </dt>
    {% elif "Law Amendments Committee" in action.description %}
        <dt data-toggle="tooltip" title="The committee considers the bill and hears from interested people and organizations">
          {{ action.description }}
        </dt>
    {% elif "Reported to the House" in action.description %}
        <dt data-toggle="tooltip" title="The House votes to refer the bill to the Committee of the Whole House on Bills">
          {{ action.description }}
        </dt>
    {% elif "Committee of the Whole House" in action.description %}
        <dt data-toggle="tooltip" title="The Committee of the Whole House on Bills examines each clause of the bill">
          {{ action.description }}
        </dt>
    {% elif action.description == "Third Reading" %}
        <dt data-toggle="tooltip" title="The House votes to pass the bill">
          {{ action.description }}
        </dt>
    {% elif "Royal Assent" in action.description %}
        <dt data-toggle="tooltip" title="The Lieutenant Governor signs the bill into law">
          {{ action.description }}
        </dt>
    {% elif "Commencement" in action.description %}
        <dt data-toggle="tooltip" title="The law comes into force">
          {{ action.description }}
        </dt>
    {% else %}
        <dt>
          {{ action.description }}
        </dt>
    {% endif %}
        <dd>
    {% if "Law Amendments Committee" in action.description %}
          <a href="{{ bill.law_amendments_committee_submissions_url }}" target="_blank">{{ action.text }} <span class="glyphicon glyphicon-new-window"></span></a>
    {% elif action.text %}
          {{ action.text }}
    {% elif "Meeting Date(s)" in action.description %}
          {{ action.date|date:"F j, Y" }}
    {% elif "Commencement" in action.description %}
          {{ action.date|date:"F j, Y" }}
    {% else %}
          <a href="{% url 'legislature:haystack_search' %}?q=Bill%20{{ bill.identifier }}%20start_date%3A{{ action.date|date:"Y-m-d" }}">{{ action.date|date:"F j, Y" }}</a>
    {% endif %}
        </dd>
  {% endif %}
{% endfor %}
      </dl>
    </div>
  </div>
{% endblock %}
