{% load firstof url from future %}
{% load staticfiles speech_utils legislature_extras %}

{% if speech.speaker_display %}
  {% if speech.speaker.image %}
<div class="image">
  <a href="{% url 'legislature:speaker-view' speech.speaker.slug %}">
    <img src="{{ speech.speaker.image }}" alt="">
  </a>
</div>
  {% endif %}
<p class="from">
  {% if speech.speaker_id %}
  <a href="{% url 'legislature:speaker-view' speech.speaker.slug %}">
    {{ speech|speech_speaker }}
  </a>
  {% else %}
  {{ speech|speech_speaker }}
  {% endif %}
</p>
{% endif %}

<div class="speech">
{{ speech.text|bleach }}
</div>

{% if speech.speaker_display %}
<div class="actions">
  <a href="#s{{ speech.id }}" class="link">
    <span class="glyphicon glyphicon-link"></span> Link
  </a>
  <a href="https://twitter.com/share?related=SpringtideCo%3Aopenhousens.ca&amp;url={{ request.build_absolute_uri|urlencode }}%23s{{speech.id}}&amp;text={{ speech|tweet_text }}&amp;via=SpringtideCo" class="twitter">
    <img src="{% static 'img/twitter.png' %}" width="20" height="16" alt=""> Tweet
  </a>
</div>
{% endif %}